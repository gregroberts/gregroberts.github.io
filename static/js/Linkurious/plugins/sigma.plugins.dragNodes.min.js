(function(a){"use strict";if("undefined"==typeof sigma)throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.settings");var b={dragNodeStickiness:0};sigma.settings=sigma.utils.extend(sigma.settings||{},b)}).call(this),function(){"use strict";function a(a,b,c){function d(a){var b=window.getComputedStyle(a),c=function(a){return parseInt(b.getPropertyValue(a).replace("px",""))||0};return{left:a.getBoundingClientRect().left+c("padding-left"),top:a.getBoundingClientRect().top+c("padding-top")}}function e(a){w=!1,n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),u.length?setTimeout(function(){r=u[u.length-1],p.addEventListener("mousedown",h)},0):r=null}function f(a){if(0!=a.data.enter.nodes.length){var b=a.data.enter.nodes[0];v[b.id]||(u.push(b),v[b.id]=!0,w||(r=u[u.length-1],p.addEventListener("mousedown",h)))}}function g(a){if(0!=a.data.leave.nodes.length){var b=a.data.leave.nodes[0],c=u.map(function(a){return a}).indexOf(b);u.splice(c,1),delete v[b.id],u.length&&!w?r=u[u.length-1]:p.removeEventListener("mousedown",h)}}function h(a){3!=a.which&&(w=!0,r&&l.graph.nodes().length>0&&(p.removeEventListener("mousedown",h),n.addEventListener("mousemove",j),n.addEventListener("mouseup",i),o.settings({mouseEnabled:!1,enableHovering:!1}),k.dispatchEvent("startdrag",{node:r,captor:a,renderer:o})))}function i(a){if(w=!1,p.addEventListener("mousedown",h),n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),o.settings({mouseEnabled:!0,enableHovering:!0}),x){if(k.dispatchEvent("drop",{node:r,captor:a,renderer:o}),m)for(var b=m.nodes(),c=0;c<b.length;c++)delete b[c].alphaX,delete b[c].alphaY;l.refresh()}k.dispatchEvent("dragend",{node:r,captor:a,renderer:o}),x=!1,r=null}function j(a){function b(){var b,c,e,f,g,h,i,j=d(o.container),n=a.clientX-j.left,p=a.clientY-j.top,u=Math.cos(q.angle),v=Math.sin(q.angle),w=l.graph.nodes(),z=[];if(!(w.length<2)){for(var A=0;2>A;A++)f=w[A],f&&(g={x:f.x*u+f.y*v,y:f.y*u-f.x*v,renX:f[t+"x"],renY:f[t+"y"]},z.push(g));if(n=(n-z[0].renX)/(z[1].renX-z[0].renX)*(z[1].x-z[0].x)+z[0].x,p=(p-z[0].renY)/(z[1].renY-z[0].renY)*(z[1].y-z[0].y)+z[0].y,b=n*u-p*v,c=p*u+n*v,!(y>0&&(i=sigma.utils.getDistance(b,c,r.x,r.y),y>i))){if(m&&(e=m.nodes(),h=-1<e.map(function(a){return a.id}).indexOf(r.id)))for(var A=0;A<e.length;A++)s!=r&&(e[A].alphaX=null,e[A].alphaY=null),e[A].alphaX&&e[A].alphaY||(e[A].alphaX=e[A].x-n,e[A].alphaY=e[A].y-p),e[A].x=r.x+e[A].alphaX,e[A].y=r.y+e[A].alphaY;r.x=b,r.y=c,l.refresh({skipIndexation:!0}),x=!0,k.dispatchEvent("drag",{node:r,captor:a,renderer:o}),s=r}}}if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){clearTimeout(c);var c=setTimeout(b,0)}else b()}if(sigma.classes.dispatcher.extend(this),sigma.renderers.webgl&&b instanceof sigma.renderers.webgl)throw new Error("The sigma.plugins.dragNodes is not compatible with the WebGL renderer");var k=this,l=a,m=c,n=document.body,o=b,p=b.container.lastChild,q=b.camera,r=null,s=null,t=b.options.prefix,u=[],v={},w=!1,x=!1,y=a.settings("dragNodeStickiness");b instanceof sigma.renderers.svg&&(p=b.container.firstChild),b.bind("hovers",f),b.bind("hovers",g),b.bind("click",e),l.bind("kill",function(){k.unbindAll()}),this.unbindAll=function(){p.removeEventListener("mousedown",h),n.removeEventListener("mousemove",j),n.removeEventListener("mouseup",i),o.unbind("hovers",f),o.unbind("hovers",g)}}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var b={};sigma.plugins.dragNodes=function(c,d,e){return b[c.id]||(b[c.id]=new a(c,d,e)),c.bind("kill",function(){sigma.plugins.killDragNodes(c)}),b[c.id]},sigma.plugins.killDragNodes=function(c){b[c.id]instanceof a&&(b[c.id].unbindAll(),delete b[c.id])}}.call(window);
//# sourceMappingURL=sigma.plugins.dragNodes.min.js.map